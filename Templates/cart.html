{% extends "base.html" %}
{% load static %}
{% block content %}
<h1>Your Cart</h1>

{% if cart|length == 0 %}
  <p>Cart is empty. <a href="{% url 'home' %}">Continue shopping</a></p>
{% else %}
  <table border="1" cellpadding="8" cellspacing="0">
    <thead>
      <tr>
        <th>Product</th>
        <th>Unit price</th>
        <th>Qty</th>
        <th>Line total</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for item in cart %}
      <tr>
        <td>
          {{ item.product.name }}
        </td>
        <td>{{ item.price }}</td>
        <td>
          <form action="{% url 'cart_update' item.product.id %}" method="post" style="display:flex; gap:6px;">
            {% csrf_token %}
            <input type="number" name="quantity" value="{{ item.quantity }}" min="1" style="width:70px;">
            <button type="submit">Update</button>
          </form>
        </td>
        <td>{{ item.total_price }}</td>
        <td>
          <form action="{% url 'cart_remove' item.product.id %}" method="post">
            {% csrf_token %}
            <button type="submit">Remove</button>
          </form>
        </td>
      </tr>
      {% endfor %}
      <tr>
        <td colspan="3" align="right"><strong>Total</strong></td>
        <td colspan="2"><strong>{{ cart.get_total_price }}</strong></td>
      </tr>
    </tbody>
  </table>

  <div style="margin-top:16px; display:flex; gap:12px;">
    <a href="{% url 'home' %}">‚Üê Continue shopping</a>
  </div>
{% endif %}
{% endblock %}
